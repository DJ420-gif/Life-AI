<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
    <style>
        /* Global Styles */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            color: #333;
        }
        .chat-container {
            max-width: 600px;
            width: 100%;
            height: 90vh;
            margin: 20px auto;
            display: flex;
            flex-direction: column;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fff;
            overflow: hidden;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #eee;
        }
        .header h1 {
            margin: 0;
            font-size: 1.2rem;
        }
        /* Toggle Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            border-radius: 24px;
            transition: .4s;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        /* Chat window */
        #chat-window {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background-color: #fefefe;
        }
        .message {
            margin: 5px 0;
            padding: 10px;
            max-width: 75%;
            border-radius: 16px;
            position: relative;
            animation: fadeIn 0.4s ease-in;
        }
        .message.bot {
            background-color: #e2e2e2;
            align-self: flex-start;
            border-top-left-radius: 0;
        }
        .message.user {
            background-color: #0084ff;
            color: #fff;
            align-self: flex-end;
            border-top-right-radius: 0;
        }
        @keyframes fadeIn {
            from {opacity: 0; transform: translateY(10px);}
            to {opacity: 1; transform: translateY(0);}
        }
        /* Input area */
        .input-area {
            display: flex;
            align-items: center;
            padding: 10px;
            border-top: 1px solid #ccc;
            background-color: #eee;
        }
        .input-area input {
            flex: 1;
            padding: 10px;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .input-area button {
            margin-left: 5px;
            padding: 10px 15px;
            font-size: 1rem;
            background-color: #0084ff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        /* Category and suggestions */
        .categories {
            display: flex;
            gap: 5px;
            padding: 10px;
            border-top: 1px solid #ccc;
            background-color: #eee;
            overflow-x: auto;
        }
        .category-btn {
            background-color: #ddd;
            border: none;
            border-radius: 12px;
            padding: 8px 12px;
            cursor: pointer;
        }
        .category-btn.active {
            background-color: #bbb;
        }
        .suggestions {
            display: flex;
            gap: 5px;
            padding: 10px;
            flex-wrap: wrap;
        }
        .suggestion-btn {
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 12px;
            padding: 6px 10px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        /* Dark mode */
        .dark-mode {
            background-color: #333;
            color: #ddd;
        }
        .dark-mode .chat-container {
            background-color: #555;
            border-color: #666;
        }
        .dark-mode .header {
            background-color: #666;
        }
        .dark-mode #chat-window {
            background-color: #555;
        }
        .dark-mode .input-area {
            background-color: #666;
            border-top-color: #777;
        }
        .dark-mode .input-area input {
            background-color: #777;
            color: #ddd;
            border-color: #888;
        }
        .dark-mode .input-area button {
            background-color: #005bb5;
        }
        .dark-mode .categories {
            background-color: #666;
        }
        .dark-mode .category-btn {
            background-color: #777;
            color: #ddd;
        }
        .dark-mode .category-btn.active {
            background-color: #888;
        }
        .dark-mode .suggestions {
            background-color: #666;
        }
        .dark-mode .suggestion-btn {
            background-color: #777;
            color: #ddd;
            border-color: #888;
        }
        .dark-mode .message.bot {
            background-color: #777;
        }
        .dark-mode .message.user {
            background-color: #2196f3;
        }
    </style>
</head>
<body>
<div class="chat-container">
    <div class="header">
        <h1>ChatBot</h1>
        <label class="switch">
            <input type="checkbox" id="modeToggle">
            <span class="slider"></span>
        </label>
    </div>
    <div class="categories">
        <button class="category-btn" data-category="General">General</button>
        <button class="category-btn" data-category="Technical">Technical</button>
        <button class="category-btn" data-category="Fun">Fun</button>
        <button class="category-btn" data-category="Personal">Personal</button>
    </div>
    <div id="suggestions" class="suggestions"></div>
    <div id="chat-window"></div>
    <div class="input-area">
        <input type="text" id="chatInput" placeholder="Type a message...">
        <button id="sendBtn">Send</button>
    </div>
    <div class="input-area">
        <button id="exportBtn">Export Chat</button>
        <button id="clearBtn">Clear Chat</button>
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Elements
        const chatWindow = document.getElementById('chat-window');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const exportBtn = document.getElementById('exportBtn');
        const clearBtn = document.getElementById('clearBtn');
        const modeToggle = document.getElementById('modeToggle');
        const categoryButtons = document.querySelectorAll('.category-btn');
        const suggestionsDiv = document.getElementById('suggestions');
        
        // Q&A Data (questions and answers)
        const qaData = {
            General: [
                { q: "What is your name?", a: "My name is ChatBot." },
                { q: "How are you?", a: "I'm doing well, thank you!" },
                { q: "What can you do?", a: "I can chat with you and answer simple questions." }
            ],
            Technical: [
                { q: "What is AI?", a: "AI stands for Artificial Intelligence." },
                { q: "What is JavaScript?", a: "JavaScript is a programming language used for web development." },
                { q: "How do computers work?", a: "Computers work by processing binary data through a CPU." }
            ],
            Fun: [
                { q: "Tell me a joke", a: "Why did the developer go broke? Because he used up all his cache." },
                { q: "Make a funny statement", a: "I'm a chatbot, but I think I'm pretty pun-derful." },
                { q: "Do you like music?", a: "Yes, I like all the algorithms." }
            ],
            Personal: [
                { q: "Where are you from?", a: "I exist in cyberspace." },
                { q: "Do you have a favorite color?", a: "I like all colors equally!" },
                { q: "What is your purpose?", a: "I'm here to assist and chat with you." }
            ]
        };
        
        // Generic replies for unmatched questions
        const genericReplies = [
            "Maybe try rephrasing your question?",
            "I'm still learning, so I don't know much about that.",
            "Let's talk about something else!",
            "That's beyond my current knowledge.",
            "I'm not sure about that."
        ];
        
        // Load dark mode state
        if (localStorage.getItem('darkMode') === 'true') {
            document.body.classList.add('dark-mode');
            modeToggle.checked = true;
        }
        
        // Restore chat history
        let savedChat = JSON.parse(localStorage.getItem('chatHistory') || "[]");
        savedChat.forEach(item => {
            addMessage(item.content, item.sender, false);
        });
        
        // Scroll to bottom
        chatWindow.scrollTop = chatWindow.scrollHeight;
        
        // Event listeners
        sendBtn.addEventListener('click', () => {
            const text = chatInput.value.trim();
            if (text !== '') {
                handleUserMessage(text);
                chatInput.value = '';
            }
        });
        chatInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                sendBtn.click();
            }
        });
        exportBtn.addEventListener('click', exportChat);
        clearBtn.addEventListener('click', clearChat);
        modeToggle.addEventListener('change', toggleMode);
        
        categoryButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                // Highlight active category
                categoryButtons.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                // Show suggestions for this category
                showSuggestions(this.getAttribute('data-category'));
            });
        });
        
        // Handle suggestion button clicks (event delegation)
        suggestionsDiv.addEventListener('click', function(e) {
            if (e.target.classList.contains('suggestion-btn')) {
                const question = e.target.textContent;
                handleUserMessage(question);
            }
        });
        
        // Functions
        
        function handleUserMessage(text) {
            // Add user message
            addMessage(text, 'user', true);
            // Bot typing indicator
            const typingElem = document.createElement('div');
            typingElem.className = 'message bot typing';
            typingElem.textContent = '...';
            chatWindow.appendChild(typingElem);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            // Bot response after delay
            setTimeout(() => {
                typingElem.remove();
                const answer = getAnswer(text);
                addMessage(answer, 'bot', true);
            }, 1000);
        }
        
        function getAnswer(question) {
            // Normalize question text
            const normalized = question.trim().replace(/[?!.]/g, '').toLowerCase();
            for (let category in qaData) {
                for (let pair of qaData[category]) {
                    const qNorm = pair.q.trim().replace(/[?!.]/g, '').toLowerCase();
                    if (qNorm === normalized) {
                        return pair.a;
                    }
                }
            }
            // Not found, return generic reply
            const randomIndex = Math.floor(Math.random() * genericReplies.length);
            return "I'm not sure, but here's what I think: " + genericReplies[randomIndex];
        }
        
        function addMessage(text, sender, save=true) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', sender);
            messageDiv.textContent = text;
            chatWindow.appendChild(messageDiv);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            if (save) {
                // Save to local storage
                savedChat.push({ sender: sender, content: text });
                localStorage.setItem('chatHistory', JSON.stringify(savedChat));
            }
        }
        
        function showSuggestions(category) {
            suggestionsDiv.innerHTML = '';
            const qList = qaData[category];
            if (!qList) return;
            qList.forEach(pair => {
                const btn = document.createElement('button');
                btn.className = 'suggestion-btn';
                btn.textContent = pair.q;
                suggestionsDiv.appendChild(btn);
            });
        }
        
        function exportChat() {
            let chatText = '';
            savedChat.forEach(item => {
                const prefix = item.sender === 'user' ? 'User: ' : 'Bot: ';
                chatText += prefix + item.content + "\n";
            });
            const blob = new Blob([chatText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'chat.txt';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function clearChat() {
            if (confirm("Are you sure you want to clear the chat?")) {
                chatWindow.innerHTML = '';
                localStorage.removeItem('chatHistory');
                savedChat = [];
            }
        }
        
        function toggleMode() {
            if (modeToggle.checked) {
                document.body.classList.add('dark-mode');
                localStorage.setItem('darkMode', 'true');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('darkMode', 'false');
            }
        }
    });
    </script>
</div>
</body>
   </html>
